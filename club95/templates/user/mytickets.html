{% extends "base.html" %} {% block body %}

<div class="main-window">
    <!-- Search Section -->
    <section class="search-section">
        <div class="container" id="search-container">
            <!-- Search bar -->
            <form class="d-flex" role="search">
                <input
                    class="form-control me-2"
                    type="search"
                    placeholder="Search for events..."
                    aria-label="Search"
                    id="search-bar"
                />
                <!-- Search button -->
                <button class="btn" type="submit" id="search-confirm-btn">
                    Search
                </button>
            </form>
            <div class="btn-group" id="filter-btn-group">
                <!-- Ana: Event Type filter dropdown -->
                <!-- This section adds a dropdown filter that lets users select one or more event types (e.g. concert, DJ set, etc.) -->
                <div class="filter-btn-wrapper">
                    <button
                        class="btn dropdown-toggle"
                        data-bs-toggle="dropdown"
                        type="submit"
                        id="event-type-filter-btn"
                    >
                        Event Type
                    </button>
                    <ul
                        class="dropdown-menu dropdown-menu-end"
                        id="dropdown-menu"
                    >
                        <!-- Each checkbox below represents an available event type users can filter by -->
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Live Concert </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Music Festival </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Orchestra </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> DJ Set </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text">
                                Solo Artist Performance
                            </span>
                        </li>
                    </ul>
                </div>
                <!-- End of Event Type(s) filter button -->

                <!-- Event Genre(s) filter button -->
                <!-- This section adds a dropdown menu that lets users filter events by music genre (like Pop, Jazz, Rock, etc.). -->
                <div class="filter-btn-wrapper">
                    <button
                        class="btn dropdown-toggle"
                        data-bs-toggle="dropdown"
                        type="submit"
                        id="genres-filter-btn"
                    >
                        Genres
                    </button>
                    <ul
                        class="dropdown-menu dropdown-menu-end"
                        id="dropdown-menu"
                    >
                        <!-- Each checkbox below represents a genre that users can select to filter events -->
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Alternative </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Blues </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Classical </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text">
                                Contemporary Orchestral
                            </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Electronic </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Experimental </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Funk </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Fusion </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Indie </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Jazz </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Metal </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Pop </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Punk </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Rock </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Swing </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Synthwave </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Techno </span>
                        </li>
                    </ul>
                </div>
                <!-- End of Event Genre(s) filter button -->

                <!-- TODO: Ana - Event Status filter button -->
                <!-- This section adds a dropdown menu that lets users filter events based on their current status (e.g. Open, Sold Out, Cancelled). -->
                <div class="filter-btn-wrapper">
                    <button
                        class="btn dropdown-toggle"
                        data-bs-toggle="dropdown"
                        type="submit"
                        id="event-status-filter-btn"
                    >
                        Status
                    </button>
                    <ul
                        class="dropdown-menu dropdown-menu-end"
                        id="dropdown-menu"
                    >
                        <!-- Each checkbox below represents a possible event status users can filter by -->
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Open </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Inactive </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Sold Out </span>
                        </li>
                        <li class="d-flex align-items-center">
                            <input
                                class="form-check-input mt-0 ms-2"
                                type="checkbox"
                                id="event-checkbox"
                                value=""
                            />
                            <span class="dropdown-text"> Cancelled </span>
                        </li>
                    </ul>
                </div>
                <!-- End of Event Status filter button -->
            </div>
            <!-- End of btn group -->
        </div>
        <!-- End of search container -->
    </section>
    <!-- End of Search Section -->

    <!-- TODO: Nate please fix - My Tickets Section -->
    <section class="my-tickets-page">
        <!-- Events Page Container -->
        <div class="container" id="my-tickets-page-container">
            <div class="row justify-content-center gy-4">
                {% for order in orders %} {% set primary_item =
                order.line_items[0] if order.line_items else None %} {% set
                event = primary_item.ticket.event if primary_item and
                primary_item.ticket else None %}
                <div class="col-12 col-lg-8 d-flex">
                    <div class="window" id="order-{{ order.id }}">
                        <div class="title-bar">
                            <span class="window-title">
                                (ORDER ID: #{{ '%08d' % order.id }}) {{
                                event.title if event else 'Event Details' }}
                            </span>
                            <div class="window-controls">
                                <button type="button" class="btn" href="#!">
                                    _
                                </button>
                                <button type="button" class="btn" href="#!">
                                    ☐
                                </button>
                                <button
                                    type="button"
                                    class="btn"
                                    id="closebtn"
                                    href="#!"
                                >
                                    X
                                </button>
                            </div>
                        </div>

                        <div class="sub-window">
                            <img
                                src="{{ url_for('static', filename='img/' ~ event.image) if event and event.image else url_for('static', filename='img/crescent-city-players-poster-horizontal.jpg') }}"
                                class="window-img-top img-fit"
                                alt="{{ event.title if event else 'Event poster' }}"
                            />
                            <section class="window-tags">
                                {% set event_type_label = (event.event_type.typeName if event and event.event_type else 'Event') %}
                                <span class="badge" id="event-type">
                                    {{ event_type_label }}
                                </span>
                                <span class="badge" id="event-status-open">
                                    {{ event.status if event and event.status
                                    else 'OPEN' }}
                                </span>
                            </section>
                            <p class="sub-window-content">
                                <strong>> ORDER DATE:</strong>
                                {{ order.order_date.strftime('%b %d, %Y') if
                                order.order_date else 'Pending' }}
                                <br />
                                <strong>> PURCHASED TICKET(s):</strong>
                                <br />
                                {% for line_item in order.line_items %} {{
                                line_item.quantity }}x {{
                                line_item.ticket.ticketTier }} – ${{
                                '%.2f'|format(line_item.price_at_purchase) }}
                                <br />
                                {% endfor %}
                                <br />
                                <strong>> DESCRIPTION: </strong>
                                {{ event.description if event and
                                event.description else 'No description
                                available.' }}
                                <br />
                                <br />
                                <strong>> ARTIST LINEUP:</strong>
                                {% if event and event.artist_links %}
                                    {% for link in event.artist_links %}
                                        {{ link.artist.artistName }}{% if link.set_time %} ({{ link.set_time }}){% endif %}{% if not loop.last %}, {% endif %}
                                    {% endfor %}
                                {% elif event and event.artists %}
                                    {% for artist in event.artists %}
                                        {{ artist.artistName }}{% if not loop.last %}, {% endif %}
                                    {% endfor %}
                                {% else %}
                                    Not available
                                {% endif %}
                                <br />
                                <strong>> VENUE:</strong>
                                {{ event.venue.location if event and event.venue else 'TBA' }}
                                <br />
                                <strong>> DATE:</strong>
                                {{ event.date if event and event.date else 'TBA'
                                }}
                                <br />
                                <strong>> TIME:</strong>
                                {{ event.start_time if event and
                                event.start_time else 'TBA' }} {% if event and
                                event.end_time %}-{{ event.end_time }}{% endif
                                %}
                                <br />
                                <strong>> GENRES:</strong>
                                {% if event and event.genres %} {% for genre in
                                event.genres %}
                                <a class="genre-search-link" href="{{ url_for('user_bp.mytickets', search=genre.genreType) }}">{{ genre.genreType }}</a>{% if not
                                loop.last %}, {% endif %} {% endfor %} {% else
                                %}
                                <span>N/A</span>
                                {% endif %}
                            </p>
                            <a
                                class="btn"
                                id="view-details-btn"
                                href="{{ url_for('events_bp.eventdetails', event_id=event.id) if event else '#!' }}"
                            >
                                View details
                            </a>
                        </div>
                    </div>
                </div>
                {% else %}
                <div class="col-12 col-lg-8 d-flex">
                    <div class="window" id="no-orders-window">
                        <div class="title-bar">
                            <span class="window-title">No Orders Yet</span>
                            <div class="window-controls">
                                <button type="button" class="btn" href="#!">
                                    _
                                </button>
                                <button type="button" class="btn" href="#!">
                                    ☐
                                </button>
                                <button
                                    type="button"
                                    class="btn"
                                    id="closebtn"
                                    href="#!"
                                >
                                    X
                                </button>
                            </div>
                        </div>
                        <div class="sub-window">
                            <p class="sub-window-content">
                                Purchase tickets to see them listed here.
                            </p>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            <!-- End of row -->


                <!-- Padding -->
                <div class="col-sm-0 col-md-3"></div>
            </div>
            <!-- End of row -->
        </div>
        <!-- End of Events Page Container -->
    </section>
    <!-- End of Events List Section -->
</div>
{% endblock %}
